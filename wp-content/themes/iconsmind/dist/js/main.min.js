"use strict";!function(){$(function(){$.each($(".drop-menu"),function(){new i($(this))}),$.each($(".message-field"),function(){new n($(this))}),$(document).on("invalid.wpcf7",function(){$(".contact-us__form").find("fieldset").removeClass("novalid"),$(".contact-us__form").find(".wpcf7-not-valid-tip").each(function(){$(this).parents("fieldset").addClass("novalid")})}),$.each($("#mc-embedded-subscribe-form"),function(){new e($(this))})});var e=function(e){var i=e,n=e.data("thank"),t=$(".promo_inner").data("action"),s="",o=function(){i.on("submit",function(){return s=$("#mce-EMAIL").val(),s.length<4?a():($("#mce-EMAIL").removeClass("mce_inline_error"),r()),!1})},a=function(){$("#mce-EMAIL").addClass("mce_inline_error")},r=function(){$.ajax({url:t,data:{EMAIL:s,action:"mchimp"},type:"POST",dataType:"json",success:function(e){"success"==e.result?(i[0].reset(),window.location.href=n):a()},error:function(){a()}})},c=function(){o()};c()},i=function(e){var i,n,t=e,s=$(".site__header__menu-btn"),o=$(".site__header"),a=(t.find(".drop-menu__inner"),t.find("#scroll-wrap")),r=!1,c=$(".site"),d=$("html"),h=$(window),l=function(){s.on({click:function(){return o.hasClass("site__header_drop-menu")?(o.removeClass("site__header_drop-menu"),c.css({height:""}),setTimeout(function(){c.height()>h.height()&&d.css({"overflow-y":""}),h.scrollTop(n),$(a).getNiceScroll().hide()},10)):(o.addClass("site__header_drop-menu"),n=h.scrollTop(),o.removeClass("site__header_fixed-white"),setTimeout(function(){c.height()>h.height()&&d.css({"overflow-y":"scroll"}),setTimeout(function(){c.css({height:"100%"}),f()},10),setTimeout(function(){$(a).getNiceScroll().show(),$(a).getNiceScroll().resize()},310)},300)),!1}}),h.on({scroll:function(){r=h.scrollTop()>=o.innerHeight(),r?o.addClass("site__header_fixed-white"):o.removeClass("site__header_fixed-white")},load:function(){r?o.addClass("site__header_fixed-white"):o.removeClass("site__header_fixed-white")},DOMMouseScroll:function(e){var i=e.originalEvent.detail;if(i){var n=i>0?1:-1;u(n)}},mousewheel:function(e){var i=e.originalEvent.wheelDelta;if(i){var n=i>0?-1:1;u(n)}},touchmove:function(e){var n=e.originalEvent.touches[0].clientY;n>i?u(-1):n<i&&u(1),i=n},keydown:function(e){switch(e.which){case 32:u(1);break;case 33:u(-1);break;case 34:u(1);break;case 35:u(1);break;case 36:u(-1);break;case 38:u(-1);break;case 40:u(1);break;default:return}}})},u=function(e){e>0&&!o.hasClass("site__header_hidden")&&r&&!o.hasClass("site__header_drop-menu")&&o.addClass("site__header_hidden"),e<0&&o.hasClass("site__header_hidden")&&r&&o.removeClass("site__header_hidden")},f=function(){$(a).niceScroll({autohidemode:"false",cursorborder:"",cursorcolor:"#fff",cursorwidth:"6px",cursorborderradius:"0"})},_=function(){l()};_()},n=function(e){var i=e,n=i.find(".contact-us__form__message"),t=i.find(".message-field__text"),s=i.find(".message-field__height"),o=function(){i.on({keydown:function(){t.html(n.val()+"___"),n.css("height",t.height()+25),s.css("height",t.height())}})},a=function(){o()};a()}}();
!function(){$(function(){$(".popup").each(function(){new o($(this))})});var o=function(o){var n=this,t=40,i=$(".popup__open"),e=o,p=e.find(".popup__close, .popup__cancel"),c=e.find(".popup__wrap"),u=e.find(".popup__content"),s=$("html"),d=$(window),a=setTimeout(function(){},1),f=function(){d.height()-2*t-c.height()>0?c.css({top:(d.height()-2*t-c.height())/2}):c.css({top:0})},r=function(){var o,n=document.createElement("div");return n.className="popup__scrollbar-measure",document.body.appendChild(n),o=n.offsetWidth-n.clientWidth,document.body.removeChild(n),o},l=function(){e.css({overflowY:"hidden"}),setTimeout(function(){s.css({overflowY:"auto",paddingRight:0})},400),e.removeClass("popup_opened"),e.addClass("popup_hide"),a=setTimeout(function(){e.css({overflowY:"auto"}),e.removeClass("popup_hide")},800)},h=function(){e[0].obj=n,_()},_=function(){d.on({resize:function(){f()}}),i.on({click:function(){return m($(this).attr("data-popup")),!1}}),c.on({click:function(o){o.stopPropagation()}}),e.on({click:function(){return l(),!1}}),p.on({click:function(){return l(),!1}})},m=function(o){v(o),setTimeout(function(){s.css({overflowY:"hidden",paddingRight:r()})},400),e.addClass("popup_opened"),f()},v=function(o){var n=u.filter(".popup__"+o);u.css({display:"none"}),n.css({display:"block"})};h()}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LnBvcHVwLmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiTWVudSIsInRoaXMiLCJNZXNzYWdlSGlnaCIsImRvY3VtZW50Iiwib24iLCJmaW5kIiwicmVtb3ZlQ2xhc3MiLCJwYXJlbnRzIiwiYWRkQ2xhc3MiLCJNQyIsIm9iaiIsIl9vYmoiLCJfdGhhbmtwYWdlIiwiZGF0YSIsIl9kYXRhX2FjdGlvbiIsIl9tYWlsIiwiX29uRXZlbnRzIiwidmFsIiwibGVuZ3RoIiwiX3NldEVycm9yIiwiX3NlbmQiLCJhamF4IiwidXJsIiwiRU1BSUwiLCJhY3Rpb24iLCJ0eXBlIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwicmVzcCIsInJlc3VsdCIsInJlc2V0Iiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZXJyb3IiLCJpbml0IiwiX2xhc3RQb3MiLCJzaXRlU2Nyb2xsVG9wIiwiX2J0biIsIl9oZWFkZXIiLCJfbWVudUNvbnRlbnQiLCJfYWN0aW9uIiwiX3NpdGUiLCJfZG9tIiwiX3dpbmRvdyIsImNsaWNrIiwiaGFzQ2xhc3MiLCJjc3MiLCJoZWlnaHQiLCJzZXRUaW1lb3V0Iiwib3ZlcmZsb3cteSIsInNjcm9sbFRvcCIsImdldE5pY2VTY3JvbGwiLCJoaWRlIiwiX2luaXRDb250ZW50U2Nyb2xsIiwic2hvdyIsInJlc2l6ZSIsInNjcm9sbCIsImlubmVySGVpZ2h0IiwibG9hZCIsIkRPTU1vdXNlU2Nyb2xsIiwiZSIsImRlbHRhIiwib3JpZ2luYWxFdmVudCIsImRldGFpbCIsImRpcmVjdGlvbiIsIl9jaGVja1Njcm9sbCIsIm1vdXNld2hlZWwiLCJ3aGVlbERlbHRhIiwidG91Y2htb3ZlIiwiY3VycmVudFBvcyIsInRvdWNoZXMiLCJjbGllbnRZIiwia2V5ZG93biIsIndoaWNoIiwibmljZVNjcm9sbCIsImF1dG9oaWRlbW9kZSIsImN1cnNvcmJvcmRlciIsImN1cnNvcmNvbG9yIiwiY3Vyc29yd2lkdGgiLCJjdXJzb3Jib3JkZXJyYWRpdXMiLCJfaW5pdCIsIl9tZXNzYWdlIiwiX21lc3NhZ2VUZXh0IiwiX21lc3NhZ2VIZWlnaHQiLCJodG1sIiwiUG9wdXAiLCJfc2VsZiIsIl9wb3B1cFBhZGRpbmciLCJfYnRuU2hvdyIsIl9idG5DbG9zZSIsIl93cmFwIiwiX2NvbnRlbnRzIiwiX3Njcm9sbENvbnRlaW5lciIsIl90aW1lciIsIl9jZW50ZXJXcmFwIiwidG9wIiwiX2dldFNjcm9sbFdpZHRoIiwic2Nyb2xsQmFyV2lkdGgiLCJzY3JvbGxEaXYiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiYm9keSIsImFwcGVuZENoaWxkIiwib2Zmc2V0V2lkdGgiLCJjbGllbnRXaWR0aCIsInJlbW92ZUNoaWxkIiwiX2hpZGUiLCJvdmVyZmxvd1kiLCJwYWRkaW5nUmlnaHQiLCJfc2hvdyIsImF0dHIiLCJzdG9wUHJvcGFnYXRpb24iLCJfc2V0UG9wdXBDb250ZW50IiwiY3VyQ29udGVudCIsImZpbHRlciIsImRpc3BsYXkiXSwibWFwcGluZ3MiOiJBQUFBLGNBQ0EsV0FFSUEsRUFBRyxXQUVDQSxFQUFFQyxLQUFNRCxFQUFHLGNBQWdCLFdBQ3ZCLEdBQUtFLEdBQU1GLEVBQUdHLFNBR2xCSCxFQUFFQyxLQUFNRCxFQUFHLGtCQUFvQixXQUMzQixHQUFJSSxHQUFhSixFQUFHRyxTQUd4QkgsRUFBRUssVUFBVUMsR0FBSSxnQkFBa0IsV0FDOUJOLEVBQUcscUJBQXNCTyxLQUFNLFlBQWFDLFlBQWEsV0FDekRSLEVBQUcscUJBQXNCTyxLQUFNLHdCQUF5Qk4sS0FBTSxXQUMxREQsRUFBR0csTUFBT00sUUFBUyxZQUFhQyxTQUFVLGVBSWxEVixFQUFFQyxLQUFLRCxFQUFFLCtCQUFnQyxXQUNyQyxHQUFJVyxHQUFHWCxFQUFFRyxVQUtqQixJQUFJUSxHQUFLLFNBQVdDLEdBQ2hCLEdBQUlDLEdBQU9ELEVBQ1BFLEVBQWFGLEVBQUlHLEtBQU0sU0FDdkJDLEVBQWVoQixFQUFFLGdCQUFnQmUsS0FBSyxVQUN0Q0UsRUFBUSxH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LEVBRWhEVCxHQUFVN0MsS0FBT3FFLFFBQVMsU0FDMUJGLEVBQVduRSxLQUFPcUUsUUFBUyxVQVFuQ25DIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG4oIGZ1bmN0aW9uKCl7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoICcuZHJvcC1tZW51JyApLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIG5ldyAgTWVudSggJCggdGhpcyApICk7XG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoICcubWVzc2FnZS1maWVsZCcgKSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBuZXcgTWVzc2FnZUhpZ2goICQoIHRoaXMgKSApO1xuICAgICAgICB9ICk7XG5cbiAgICAgICAgJChkb2N1bWVudCkub24oICdpbnZhbGlkLndwY2Y3JyAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoICcuY29udGFjdC11c19fZm9ybScgKS5maW5kKCAnZmllbGRzZXQnICkucmVtb3ZlQ2xhc3MoICdub3ZhbGlkJyApO1xuICAgICAgICAgICAgJCggJy5jb250YWN0LXVzX19mb3JtJyApLmZpbmQoICcud3BjZjctbm90LXZhbGlkLXRpcCcgKS5lYWNoKCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkKCB0aGlzICkucGFyZW50cyggJ2ZpZWxkc2V0JyApLmFkZENsYXNzKCAnbm92YWxpZCcgKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgICQuZWFjaCgkKCcjbWMtZW1iZWRkZWQtc3Vic2NyaWJlLWZvcm0nKSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbmV3IE1DKCQodGhpcykpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgfSApO1xuXG4gICAgdmFyIE1DID0gZnVuY3Rpb24gKCBvYmogKSB7XG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3RoYW5rcGFnZSA9IG9iai5kYXRhKCAndGhhbmsnICksXG4gICAgICAgICAgICBfZGF0YV9hY3Rpb24gPSAkKCcucHJvbW9faW5uZXInKS5kYXRhKCdhY3Rpb24nKSxcbiAgICAgICAgICAgIF9tYWlsID0gJyc7XG4gICAgICAgIHZhciBfb25FdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX29iai5vbiggJ3N1Ym1pdCcgLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF9tYWlsID0gJCggJyNtY2UtRU1BSUwnICkudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICggX21haWwubGVuZ3RoIDwgNCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zZXRFcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCggJyNtY2UtRU1BSUwnICkucmVtb3ZlQ2xhc3MoICdtY2VfaW5saW5lX2Vycm9yJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3NlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldEVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoICcjbWNlLUVNQUlMJyApLmFkZENsYXNzKCAnbWNlX2lubGluZV9lcnJvcicgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IF9kYXRhX2FjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyAnRU1BSUwnOiBfbWFpbCwgXCJhY3Rpb25cIiA6ICdtY2hpbXAnfSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXNwLnJlc3VsdCA9PSAnc3VjY2VzcycgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX29ialsgMCBdLnJlc2V0KCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gX3RoYW5rcGFnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldEVycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc2V0RXJyb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfb25FdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgaW5pdCgpXG4gICAgfTtcbiAgICBcbiAgICB2YXIgTWVudSA9IGZ1bmN0aW9uICggb2JqICkge1xuICAgICAgICB2YXIgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9idG4gPSAkKCAnLnNpdGVfX2hlYWRlcl9fbWVudS1idG4nICksXG4gICAgICAgICAgICBfaGVhZGVyID0gJCggJy5zaXRlX19oZWFkZXInKSxcbiAgICAgICAgICAgIF9tZW51SW5uZXIgPSBfb2JqLmZpbmQoICcuZHJvcC1tZW51X19pbm5lcicgKSxcbiAgICAgICAgICAgIF9tZW51Q29udGVudCA9IF9vYmouZmluZCggJyNzY3JvbGwtd3JhcCcgKSxcbiAgICAgICAgICAgIF9hY3Rpb24gPSBmYWxzZSxcbiAgICAgICAgICAgIF9sYXN0UG9zLFxuICAgICAgICAgICAgc2l0ZVNjcm9sbFRvcCxcbiAgICAgICAgICAgIF9zaXRlID0gJCgnLnNpdGUnKSxcbiAgICAgICAgICAgIF9kb20gPSAkKCAnaHRtbCcgKSxcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cgKTtcblxuICAgICAgICB2YXIgX29uRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBfYnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9oZWFkZXIuaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfZHJvcC1tZW51JyApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hlYWRlci5yZW1vdmVDbGFzcyggJ3NpdGVfX2hlYWRlcl9kcm9wLW1lbnUnICk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zaXRlLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JzogJydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggX3NpdGUuaGVpZ2h0KCkgPiBfd2luZG93LmhlaWdodCgpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RvbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cteSc6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfd2luZG93LnNjcm9sbFRvcCggc2l0ZVNjcm9sbFRvcCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIF9tZW51Q29udGVudCApLmdldE5pY2VTY3JvbGwoKS5oaWRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMCk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oZWFkZXIuYWRkQ2xhc3MoICdzaXRlX19oZWFkZXJfZHJvcC1tZW51JyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l0ZVNjcm9sbFRvcCA9IF93aW5kb3cuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hlYWRlci5yZW1vdmVDbGFzcygnc2l0ZV9faGVhZGVyX2ZpeGVkLXdoaXRlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggX3NpdGUuaGVpZ2h0KCkgPiBfd2luZG93LmhlaWdodCgpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RvbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cteSc6ICdzY3JvbGwnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NpdGUuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6ICcxMDAlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaW5pdENvbnRlbnRTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIF9tZW51Q29udGVudCApLmdldE5pY2VTY3JvbGwoKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCBfbWVudUNvbnRlbnQgKS5nZXROaWNlU2Nyb2xsKCkucmVzaXplKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzEwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbiA9IF93aW5kb3cuc2Nyb2xsVG9wKCkgPj0gX2hlYWRlci5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX2FjdGlvbiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaGVhZGVyLmFkZENsYXNzKCdzaXRlX19oZWFkZXJfZml4ZWQtd2hpdGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oZWFkZXIucmVtb3ZlQ2xhc3MoJ3NpdGVfX2hlYWRlcl9maXhlZC13aGl0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX2FjdGlvbiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaGVhZGVyLmFkZENsYXNzKCdzaXRlX19oZWFkZXJfZml4ZWQtd2hpdGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oZWFkZXIucmVtb3ZlQ2xhc3MoJ3NpdGVfX2hlYWRlcl9maXhlZC13aGl0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIERPTU1vdXNlU2Nyb2xsOiBmdW5jdGlvbiAoIGUgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YSA9IGUub3JpZ2luYWxFdmVudC5kZXRhaWw7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZGVsdGEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gKCBkZWx0YSA+IDAgKSA/IDEgOiAtMTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCggZGlyZWN0aW9uICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtb3VzZXdoZWVsOiBmdW5jdGlvbiAoIGUgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YSA9IGUub3JpZ2luYWxFdmVudC53aGVlbERlbHRhO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGRlbHRhICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9ICggZGVsdGEgPiAwICkgPyAtMSA6IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIGRpcmVjdGlvbiApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdG91Y2htb3ZlOiBmdW5jdGlvbiAoIGUgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UG9zID0gZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50UG9zID4gX2xhc3RQb3MgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIC0xICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIGN1cnJlbnRQb3MgPCBfbGFzdFBvcyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCggMSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfbGFzdFBvcyA9IGN1cnJlbnRQb3M7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAga2V5ZG93bjogZnVuY3Rpb24gKCBlICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goIGUud2hpY2ggKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIDEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCAtMSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM0IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCAxICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzUgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIDEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzNiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCggLTEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCAtMSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIDEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uKCBkaXJlY3Rpb24gKSB7XG5cbiAgICAgICAgICAgICAgICBpZiggZGlyZWN0aW9uID4gMCAmJiAhX2hlYWRlci5oYXNDbGFzcyggJ3NpdGVfX2hlYWRlcl9oaWRkZW4nICkgJiYgX2FjdGlvbiAmJiAhX2hlYWRlci5oYXNDbGFzcyggJ3NpdGVfX2hlYWRlcl9kcm9wLW1lbnUnICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIF9oZWFkZXIuYWRkQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCBkaXJlY3Rpb24gPCAwICYmIF9oZWFkZXIuaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApICYmIF9hY3Rpb24gKSB7XG4gICAgICAgICAgICAgICAgICAgIF9oZWFkZXIucmVtb3ZlQ2xhc3MoJ3NpdGVfX2hlYWRlcl9oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdENvbnRlbnRTY3JvbGwgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICQoIF9tZW51Q29udGVudCApLm5pY2VTY3JvbGwoIHtcbiAgICAgICAgICAgICAgICAgICAgYXV0b2hpZGVtb2RlOiAnZmFsc2UnLFxuICAgICAgICAgICAgICAgICAgICBjdXJzb3Jib3JkZXI6ICcnLFxuICAgICAgICAgICAgICAgICAgICBjdXJzb3Jjb2xvcjogXCIjZmZmXCIsXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvcndpZHRoOiBcIjZweFwiLFxuICAgICAgICAgICAgICAgICAgICBjdXJzb3Jib3JkZXJyYWRpdXM6IFwiMFwiXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb25FdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcblxuICAgIH07XG5cbiAgICB2YXIgTWVzc2FnZUhpZ2ggPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICB2YXIgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9tZXNzYWdlID0gX29iai5maW5kKCAnLmNvbnRhY3QtdXNfX2Zvcm1fX21lc3NhZ2UnICksXG4gICAgICAgICAgICBfbWVzc2FnZVRleHQgPSBfb2JqLmZpbmQoICcubWVzc2FnZS1maWVsZF9fdGV4dCcgKSxcbiAgICAgICAgICAgIF9tZXNzYWdlSGVpZ2h0ID0gX29iai5maW5kKCAnLm1lc3NhZ2UtZmllbGRfX2hlaWdodCcgKTtcblxuICAgICAgICB2YXIgX29uRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgICdrZXlkb3duJyA6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbWVzc2FnZVRleHQuaHRtbCggX21lc3NhZ2UudmFsKCkgKyAnX19fJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgX21lc3NhZ2UuY3NzKCAnaGVpZ2h0JywgX21lc3NhZ2VUZXh0LmhlaWdodCgpICsgMjUgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9tZXNzYWdlSGVpZ2h0LmNzcyggJ2hlaWdodCcsIF9tZXNzYWdlVGV4dC5oZWlnaHQoKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7IiwiKCBmdW5jdGlvbigpe1xuXG4gICAgJCggZnVuY3Rpb24oKXtcblxuICAgICAgICAkKCAnLnBvcHVwJyApLmVhY2goZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgbmV3IFBvcHVwKCQodGhpcykpO1xuXG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG5cbiAgICB2YXIgUG9wdXAgPSBmdW5jdGlvbiggb2JqICl7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9wb3B1cFBhZGRpbmcgPSA0MCxcbiAgICAgICAgICAgIF9idG5TaG93ID0gICQoICcucG9wdXBfX29wZW4nICksXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2J0bkNsb3NlID0gX29iai5maW5kKCAnLnBvcHVwX19jbG9zZSwgLnBvcHVwX19jYW5jZWwnICksXG4gICAgICAgICAgICBfd3JhcCA9IF9vYmouZmluZCggJy5wb3B1cF9fd3JhcCcgKSxcbiAgICAgICAgICAgIF9jb250ZW50cyA9IF9vYmouZmluZCggJy5wb3B1cF9fY29udGVudCcgKSxcbiAgICAgICAgICAgIF9zY3JvbGxDb250ZWluZXIgPSAkKCAnaHRtbCcgKSxcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cgKSxcbiAgICAgICAgICAgIF90aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7fSwgMSApO1xuXG4gICAgICAgIHZhciBwbGF5ZXI7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9jZW50ZXJXcmFwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIF93aW5kb3cuaGVpZ2h0KCkgLSAoIF9wb3B1cFBhZGRpbmcgKiAyICkgLSBfd3JhcC5oZWlnaHQoKSA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIF93cmFwLmNzcyggeyB0b3A6ICggKCBfd2luZG93LmhlaWdodCgpIC0gKCBfcG9wdXBQYWRkaW5nICogMiApICkgLSBfd3JhcC5oZWlnaHQoKSApIC8gMiB9ICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3dyYXAuY3NzKCB7IHRvcDogMCB9ICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9nZXRTY3JvbGxXaWR0aCA9IGZ1bmN0aW9uICgpe1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbEJhcldpZHRoO1xuXG4gICAgICAgICAgICAgICAgc2Nyb2xsRGl2LmNsYXNzTmFtZSA9ICdwb3B1cF9fc2Nyb2xsYmFyLW1lYXN1cmUnO1xuXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggc2Nyb2xsRGl2ICk7XG5cbiAgICAgICAgICAgICAgICBzY3JvbGxCYXJXaWR0aCA9IHNjcm9sbERpdi5vZmZzZXRXaWR0aCAtIHNjcm9sbERpdi5jbGllbnRXaWR0aDtcblxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoc2Nyb2xsRGl2KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBzY3JvbGxCYXJXaWR0aDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaGlkZSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnYXV0bycsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IDBcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgfSwgNDAwICk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAncG9wdXBfb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoICdwb3B1cF9oaWRlJyApO1xuXG4gICAgICAgICAgICAgICAgX3RpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmNzcyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX2hpZGUnICk7XG4gICAgICAgICAgICAgICAgfSwgODAwICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5TaG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3coICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcgKSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF93cmFwLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiggZSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfb2JqLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfYnRuQ2xvc2Uub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zaG93ID0gZnVuY3Rpb24oIGNsYXNzTmFtZSApe1xuICAgICAgICAgICAgICAgIF9zZXRQb3B1cENvbnRlbnQoIGNsYXNzTmFtZSApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogX2dldFNjcm9sbFdpZHRoKClcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgfSwgNDAwICk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAncG9wdXBfb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgIF9jZW50ZXJXcmFwKCk7XG5cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRQb3B1cENvbnRlbnQgPSBmdW5jdGlvbiggY2xhc3NOYW1lICl7XG4gICAgICAgICAgICAgICAgdmFyIGN1ckNvbnRlbnQgPSBfY29udGVudHMuZmlsdGVyKCAnLnBvcHVwX18nICsgY2xhc3NOYW1lICk7XG5cbiAgICAgICAgICAgICAgICBfY29udGVudHMuY3NzKCB7IGRpc3BsYXk6ICdub25lJyB9ICk7XG4gICAgICAgICAgICAgICAgY3VyQ29udGVudC5jc3MoIHsgZGlzcGxheTogJ2Jsb2NrJyB9ICk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG59ICkoKTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
